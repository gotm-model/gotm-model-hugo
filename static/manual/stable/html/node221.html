<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Update</TITLE>
<META NAME="description" CONTENT="Update">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node222.html">
<LINK REL="previous" HREF="node220.html">
<LINK REL="up" HREF="node219.html">
<LINK REL="next" HREF="node222.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html3312"
  HREF="node222.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html3308"
  HREF="node219.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html3302"
  HREF="node220.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html3310"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html3313"
  HREF="node222.html">Storing</A>
<B> Up:</B> <A NAME="tex2html3309"
  HREF="node219.html">Fortran: Module Interface seagrass</A>
<B> Previous:</B> <A NAME="tex2html3303"
  HREF="node220.html">Initialise</A>
 &nbsp; <B>  <A NAME="tex2html3311"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION000111200000000000000">
Update the sea grass model</A>
</H3>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>    subroutine do_seagrass(nlev,dt)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
Here the time depending seagrass equation suggested by
    <A
 HREF="node251.html#VerduinBackhaus2000"><SPAN  CLASS="textit">Verduin and Backhaus</SPAN> (2000)</A> is calculated. In order to
    explain the basic principle, an idealised example is examined here
    with a simplified momentum equation,

<P>
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\partial_t u - \partial_z(\nu_t \partial_z u) = -g\partial_x\zeta-C_fu|u|
    \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="270" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img912.png"
 ALT="$\displaystyle \partial_t u - \partial_z(\nu_t \partial_z u) = -g\partial_x\zeta-C_fu\vert u\vert \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">269</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
and the Lagrangian tracer equation for seagrass,
    <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\partial_t X =
    \left\{
    \begin{array}{ll}
    u & \mbox{ for } |X|< X_{\max} \mbox{ or } X \cdot u <0,\\
    0 & \mbox{ else}
    \; , \quad
    \end{array}
    \right.
    
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="313" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img913.png"
 ALT="$\displaystyle \partial_t X = \left\{ \begin{array}{ll} u &amp; \mbox{ for } \vert X...
...ax} \mbox{ or } X \cdot u &lt;0,\\ 0 &amp; \mbox{ else} \; , \quad \end{array} \right.$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">270</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <SPAN CLASS="MATH"><IMG
 WIDTH="18" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img420.png"
 ALT="$ X$"></SPAN> is the Langrangian horizontal excursion of the seagrass.
    The seagrass friction coefficient, <SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img914.png"
 ALT="$ C_f$"></SPAN>, is only non-zero at heights
    where seagrass tracers are at their excursion limits:

<P>
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
C_f =
    \left\{
    \begin{array}{ll}
    C_f^{\max} & \mbox{ for } |X|=X_{\max} \; , \quad \\
    0 & \mbox{ else} \quad .
    \end{array}
    \right.
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="263" HEIGHT="55" ALIGN="MIDDLE" BORDER="0"
 SRC="img915.png"
 ALT="$\displaystyle C_f = \left\{ \begin{array}{ll} C_f^{\max} &amp; \mbox{ for } \vert X\vert=X_{\max} \; , \quad \\ 0 &amp; \mbox{ else} \quad . \end{array} \right.$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">271</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
The maximum excursion limits <SPAN CLASS="MATH"><IMG
 WIDTH="41" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img916.png"
 ALT="$ X_{\max}$"></SPAN> and the friction coefficients
    <!-- MATH
 $C_f^{\max}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="41" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img917.png"
 ALT="$ C_f^{\max}$"></SPAN> are read from a file.

<P>
The production of turbulence is calculated here as the sum of shear
    production and friction loss at the seagrass leaves,
    <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="sgProduction"></A><!-- MATH
 \begin{equation}
X_P = \alpha_{sg} C_f |u|^3
     \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="142" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img918.png"
 ALT="$\displaystyle X_P = \alpha_{sg} C_f \vert u\vert^3 \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">272</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
which is added to the usual shear-production term as illustrated in
    (<A HREF="node69.html#computeP">146</A>). The efficiency coefficient of turbulence production
    by sea-grass friction, <!-- MATH
 $\alpha_{sg}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="27" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img919.png"
 ALT="$ \alpha_{sg}$"></SPAN>, is denoted as <TT>xP_rat</TT>
    in the code. It has to be read-in from the <TT>canopy</TT> namelist.
    For details and example calculations, see <A
 HREF="node251.html#BurchardBolding2000"><SPAN  CLASS="textit">Burchard and Bolding</SPAN> (2000)</A>.

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>    use meanflow, only:     u,v,h,drag,xP
    IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE>    integer,  intent(in)     :: nlev
    REALTYPE, intent(in)     :: dt
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>    Original author(s): Karsten Bolding &amp; Hans Burchard
</PRE><I CLASS="sans">LOCAL VARIABLES:</I>
<PRE>    integer                   :: i
    REALTYPE                  :: dist
    REALTYPE                  :: grassfric(0:nlev)
    REALTYPE                  :: excur(0:nlev)
    REALTYPE                  :: z(0:nlev)
</PRE>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html3312"
  HREF="node222.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html3308"
  HREF="node219.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html3302"
  HREF="node220.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html3310"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html3313"
  HREF="node222.html">Storing</A>
<B> Up:</B> <A NAME="tex2html3309"
  HREF="node219.html">Fortran: Module Interface seagrass</A>
<B> Previous:</B> <A NAME="tex2html3303"
  HREF="node220.html">Initialise</A>
 &nbsp; <B>  <A NAME="tex2html3311"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-01-24
</ADDRESS>
</BODY>
</HTML>
