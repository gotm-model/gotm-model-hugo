<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The dynamic k-equation (Source File: tkeeq.F90)</TITLE>
<META NAME="description" CONTENT="The dynamic k-equation (Source File: tkeeq.F90)">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node73.html">
<LINK REL="previous" HREF="node71.html">
<LINK REL="up" HREF="node48.html">
<LINK REL="next" HREF="node73.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1343"
  HREF="node73.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1339"
  HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1333"
  HREF="node71.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1341"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1344"
  HREF="node73.html">The dynamic q2/2-equation (Source</A>
<B> Up:</B> <A NAME="tex2html1340"
  HREF="node48.html">Fortran: Module Interface turbulence:</A>
<B> Previous:</B> <A NAME="tex2html1334"
  HREF="node71.html">Update time scale ratio</A>
 &nbsp; <B>  <A NAME="tex2html1342"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION000572400000000000000"></A><A NAME="sec:tkeeq"></A>
<BR>
The dynamic k-equation  (Source File: tkeeq.F90)
</H3>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>    subroutine tkeeq(nlev,dt,u_taus,u_taub,z0s,z0b,h,NN,SS)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
The transport equation for the turbulent kinetic energy, <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ k$"></SPAN>,
   follows immediately from the contraction of the Reynolds-stress
   tensor. In the case of a Boussinesq-fluid, this equation can
   be written as
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="tkeA"></A><!-- MATH
 \begin{equation}
\dot{k}
     =
     {\cal D}_k +  P + G  - \epsilon
     \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="168" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img562.png"
 ALT="$\displaystyle \dot{k} = {\cal D}_k + P + G - \epsilon \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">150</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img563.png"
 ALT="$ \dot{k}$"></SPAN> denotes the material derivative of <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ k$"></SPAN>. <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img40.png"
 ALT="$ P$"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img41.png"
 ALT="$ G$"></SPAN> are
   the production of <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ k$"></SPAN> by mean shear and buoyancy, respectively, and
   <SPAN CLASS="MATH"><IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img37.png"
 ALT="$ \epsilon$"></SPAN> the rate of dissipation. <!-- MATH
 ${\cal D}_k$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img564.png"
 ALT="$ {\cal D}_k$"></SPAN> represents the sum of
   the viscous and turbulent transport terms.
   For horizontally homogeneous flows, the transport term <!-- MATH
 ${\cal D}_k$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img564.png"
 ALT="$ {\cal D}_k$"></SPAN>
   appearing in (<A HREF="#tkeA">150</A>) is presently expressed by a simple
   gradient formulation,
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="diffusionTKE"></A><!-- MATH
 \begin{equation}
{\cal D}_k = \dfrac{\partial}{\partial {z}} \left( \dfrac{\nu_t}{\sigma_k} \dfrac{\partial {k}}{\partial {z}} \right)
    \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="162" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img565.png"
 ALT="$\displaystyle {\cal D}_k = \dfrac{\partial}{\partial {z}} \left( \dfrac{\nu_t}{\sigma_k} \dfrac{\partial {k}}{\partial {z}} \right) \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">151</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <SPAN CLASS="MATH"><IMG
 WIDTH="21" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img566.png"
 ALT="$ \sigma_k$"></SPAN> is the constant Schmidt-number for <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ k$"></SPAN>.

<P>
In horizontally homogeneous flows, the shear and the buoyancy
   production, <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img40.png"
 ALT="$ P$"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img41.png"
 ALT="$ G$"></SPAN>, can be written as
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="PandG"></A><!-- MATH
 \begin{equation}
\begin{array}{rcl}
     P &=& -  {\langle u'w' \rangle}  \dfrac{\partial {U}}{\partial {z}} -  {\langle v'w' \rangle}  \dfrac{\partial {V}}{\partial {z}}  \; , \quad \\[3mm]
     G &=&   {\langle w'b' \rangle}                                                \; , \quad
     \end{array}
   
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="232" HEIGHT="76" BORDER="0"
 SRC="img567.png"
 ALT="\begin{displaymath}\begin{array}{rcl} P &amp;=&amp; - {\langle u'w' \rangle} \dfrac{\par...
...ad \\ [3mm] G &amp;=&amp; {\langle w'b' \rangle} \; , \quad \end{array}\end{displaymath}"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">152</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
see (<A HREF="node38.html#PG">48</A>). Their computation is discussed in section <A HREF="node69.html#sec:production">4.7.21</A>.

<P>
The rate of dissipation, <SPAN CLASS="MATH"><IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img37.png"
 ALT="$ \epsilon$"></SPAN>, can be either obtained directly
   from its parameterised transport equation as discussed in
   section <A HREF="node76.html#sec:dissipationeq">4.7.28</A>, or from any other model yielding
   an appropriate description of the dissipative length-scale, <SPAN CLASS="MATH"><IMG
 WIDTH="9" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img171.png"
 ALT="$ l$"></SPAN>.
   Then, <SPAN CLASS="MATH"><IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img37.png"
 ALT="$ \epsilon$"></SPAN> follows from the well-known cascading relation
   of turbulence,
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="epsilon"></A><!-- MATH
 \begin{equation}
\epsilon = (c_\mu^0)^3 \frac{k^{\frac{3}{2}}}{l}
     \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="114" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="img568.png"
 ALT="$\displaystyle \epsilon = (c_\mu^0)^3 \frac{k^{\frac{3}{2}}}{l} \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">153</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <SPAN CLASS="MATH"><IMG
 WIDTH="19" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img468.png"
 ALT="$ c_\mu^0$"></SPAN> is a constant of the model.

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>    use turbulence,   only: P,B,num
    use turbulence,   only: tke,tkeo,k_min,eps
    use turbulence,   only: k_bc, k_ubc, k_lbc, ubc_type, lbc_type
    use turbulence,   only: sig_k
    use util,         only: Dirichlet,Neumann
 
    IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE> 
    number of vertical layers
    integer,  intent(in)                :: nlev
 
    time step (s)
    REALTYPE, intent(in)                :: dt
 
    surface and bottom
    friction velocity (m/s)
    REALTYPE, intent(in)                :: u_taus,u_taub
 
    surface and bottom
    roughness length (m)
    REALTYPE, intent(in)                :: z0s,z0b
 
    layer thickness (m)
    REALTYPE, intent(in)                :: h(0:nlev)
 
    square of shear and buoyancy
    frequency (1/s^2)
    REALTYPE, intent(in)                :: NN(0:nlev),SS(0:nlev)
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>    Original author(s): Lars Umlauf
                       (re-write after first version of
                        H. Burchard and K. Bolding)
    $Log: tkeeq.F90,v $
    Revision 1.9  2005-11-15 11:35:02  lars
    documentation finish for print
    Revision 1.8  2005/11/03 20:53:37  hb
    Patankar trick reverted to older versions for
    stabilising 3D computations
    Revision 1.7  2005/08/11 13:11:50  lars
    Added explicit loops for diffusivities for 3-D z-level support.
    Thanks to Vicente Fernandez.
    Revision 1.6  2005/06/27 13:44:07  kbk
    modified + removed traling blanks
    Revision 1.5  2003/03/28 09:20:35  kbk
    added new copyright to files
    Revision 1.4  2003/03/10 09:02:06  gotm
    Added new Generic Turbulence Model + improved documentation and cleaned up code
</PRE>

<P>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1343"
  HREF="node73.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1339"
  HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1333"
  HREF="node71.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1341"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1344"
  HREF="node73.html">The dynamic q2/2-equation (Source</A>
<B> Up:</B> <A NAME="tex2html1340"
  HREF="node48.html">Fortran: Module Interface turbulence:</A>
<B> Previous:</B> <A NAME="tex2html1334"
  HREF="node71.html">Update time scale ratio</A>
 &nbsp; <B>  <A NAME="tex2html1342"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-01-24
</ADDRESS>
</BODY>
</HTML>
