<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The dynamic q2l-equation (Source File: lengthscaleeq.F90)</TITLE>
<META NAME="description" CONTENT="The dynamic q2l-equation (Source File: lengthscaleeq.F90)">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node76.html">
<LINK REL="previous" HREF="node74.html">
<LINK REL="up" HREF="node48.html">
<LINK REL="next" HREF="node76.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1379"
  HREF="node76.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1375"
  HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1369"
  HREF="node74.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1377"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1380"
  HREF="node76.html">The dynamic epsilon-equation (Source</A>
<B> Up:</B> <A NAME="tex2html1376"
  HREF="node48.html">Fortran: Module Interface turbulence:</A>
<B> Previous:</B> <A NAME="tex2html1370"
  HREF="node74.html">The dynamic kb-equation (Source</A>
 &nbsp; <B>  <A NAME="tex2html1378"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION000572700000000000000"></A><A NAME="sec:lengthscaleeq"></A>
<BR>
The dynamic q2l-equation (Source File: lengthscaleeq.F90)
</H3>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>    subroutine lengthscaleeq(nlev,dt,depth,u_taus,u_taub,z0s,z0b,h,NN,SS)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
Following suggestions of <A
 HREF="node251.html#Rotta51a"><SPAN  CLASS="textit">Rotta</SPAN> (1951)</A>, <A
 HREF="node251.html#MellorYamada82"><SPAN  CLASS="textit">Mellor and Yamada</SPAN> (1982)</A>
   proposed an equation for the product <SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img425.png"
 ALT="$ q^2
l$"></SPAN> expressed by
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="MY"></A><!-- MATH
 \begin{equation}
\dot{\overline{q^2 l}}
     = {\cal D}_l + l ( E_1  P + E_3 G - E_2  F \epsilon )
     \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="263" HEIGHT="47" ALIGN="MIDDLE" BORDER="0"
 SRC="img581.png"
 ALT="$\displaystyle \dot{\overline{q^2 l}} = {\cal D}_l + l ( E_1 P + E_3 G - E_2 F \epsilon ) \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">160</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <!-- MATH
 $\dot{\overline{q^2 l}}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="47" ALIGN="MIDDLE" BORDER="0"
 SRC="img582.png"
 ALT="$ \dot{\overline{q^2 l}}$"></SPAN> denotes the material derivative of <SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img425.png"
 ALT="$ q^2
l$"></SPAN>.
   The production terms <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img40.png"
 ALT="$ P$"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img41.png"
 ALT="$ G$"></SPAN> follow from (<A HREF="node72.html#PandG">152</A>), and <SPAN CLASS="MATH"><IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img37.png"
 ALT="$ \epsilon$"></SPAN>
   can be computed either directly from (<A HREF="node73.html#epsilonMY">156</A>), or from (<A HREF="node72.html#epsilon">153</A>)
   with the help (<A HREF="node73.html#B1">157</A>).

<P>
The so-called wall function, <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img583.png"
 ALT="$ F$"></SPAN>, appearing in (<A HREF="#MY">160</A>) is defined by
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="F"></A><!-- MATH
 \begin{equation}
F = 1 + E_2 \left( \dfrac{l}{\kappa {\cal L}_z} \right)^2
     \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="176" HEIGHT="61" ALIGN="MIDDLE" BORDER="0"
 SRC="img584.png"
 ALT="$\displaystyle F = 1 + E_2 \left( \dfrac{l}{\kappa {\cal L}_z} \right)^2 \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">161</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
   <SPAN CLASS="MATH"><IMG
 WIDTH="13" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img110.png"
 ALT="$ \kappa$"></SPAN> being the von K&#225;rm&#225;n constant and <!-- MATH
 ${\cal L}_z$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="22" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img585.png"
 ALT="$ {\cal L}_z$"></SPAN> some
   measure for the distance from the wall. Different possiblities
   for  <!-- MATH
 ${\cal L}_z$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="22" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img585.png"
 ALT="$ {\cal L}_z$"></SPAN> are implemented in GOTM, which can be activated
   be setting the parameter <TT>MY_length</TT> in <TT>gotmturb.nml</TT> to
   appropriate values. Close to the wall, however, one always has
   <!-- MATH
 ${\cal L}_z= \overline{z}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="51" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img586.png"
 ALT="$ {\cal L}_z= \overline{z}$"></SPAN>, where <!-- MATH
 $\overline{z}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img587.png"
 ALT="$ \overline{z}$"></SPAN> is the distance from
   the wall.

<P>
For horizontally homogeneous flows, the transport term <!-- MATH
 ${\cal D}_l$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="21" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img588.png"
 ALT="$ {\cal D}_l$"></SPAN>
   appearing in (<A HREF="#MY">160</A>) is expressed by a simple gradient formulation,
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="diffusionMYlength"></A><!-- MATH
 \begin{equation}
{\cal D}_l = \dfrac{\partial}{\partial {z}} \left( q l S_l \dfrac{\partial {q^2 l}}{\partial {z}} \right)
    \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="177" HEIGHT="57" ALIGN="MIDDLE" BORDER="0"
 SRC="img589.png"
 ALT="$\displaystyle {\cal D}_l = \dfrac{\partial}{\partial {z}} \left( q l S_l \dfrac{\partial {q^2 l}}{\partial {z}} \right) \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">162</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <SPAN CLASS="MATH"><IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img590.png"
 ALT="$ S_l$"></SPAN> is a constant of the model. The values for the model
   constants recommended by <A
 HREF="node251.html#MellorYamada82"><SPAN  CLASS="textit">Mellor and Yamada</SPAN> (1982)</A> are displayed in
   table <A HREF="#tab:MY_constants">6</A>. They can be set in <TT>gotmturb.nml</TT>. Note,
   that the parameter <SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img591.png"
 ALT="$ E_3$"></SPAN> in stably stratifed flows is in principle
   a function of the so-called steady state Richardson-number,
   as discussed by <A
 HREF="node251.html#Burchard2001c"><SPAN  CLASS="textit">Burchard</SPAN> (2001b)</A>, see discussion in the context
   of (<A HREF="node51.html#Ri_st">114</A>).
   <BR><P></P>
<DIV ALIGN="CENTER"><A NAME="8192"></A>
<TABLE>
<CAPTION><STRONG>Table 6:</STRONG>
 Constants appearing in (<A HREF="#MY">160</A>)
       and (<A HREF="node73.html#epsilonMY">156</A>)</CAPTION>
<TR><TD>     <DIV ALIGN="CENTER">
<TABLE CELLPADDING=3 BORDER="1" ALIGN="CENTER">
<TR><TD ALIGN="CENTER">&nbsp;</TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img392.png"
 ALT="$ B_1$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="20" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img573.png"
 ALT="$ S_q$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img590.png"
 ALT="$ S_l$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img592.png"
 ALT="$ E_1$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img510.png"
 ALT="$ E_2$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img591.png"
 ALT="$ E_3$"></SPAN></TD>
</TR>
<TR><TD ALIGN="CENTER"><A
 HREF="node251.html#MellorYamada82"><SPAN  CLASS="textit">Mellor and Yamada</SPAN> (1982)</A></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="32" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img593.png"
 ALT="$ 16.6$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img414.png"
 ALT="$ 0.2$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img414.png"
 ALT="$ 0.2$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img326.png"
 ALT="$ 1.8$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="32" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img594.png"
 ALT="$ 1.33$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img326.png"
 ALT="$ 1.8$"></SPAN></TD>
</TR>
</TABLE>
     
</DIV></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
At the end of this routine the length-scale can be constrained according to a
   suggestion of <A
 HREF="node251.html#Galperinetal88"><SPAN  CLASS="textit">Galperin et&nbsp;al.</SPAN> (1988)</A>. This feature is optional and can be activated
   by setting <TT>length_lim = .true.</TT> in <TT>gotmturb.nml</TT>.

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>    use turbulence, only: P,B
    use turbulence, only: tke,tkeo,k_min,eps,eps_min,L
    use turbulence, only: kappa,e1,e2,e3,b1
    use turbulence, only: MY_length,cm0,cde,galp,length_lim
    use turbulence, only: q2l_bc, psi_ubc, psi_lbc, ubc_type, lbc_type
    use turbulence, only: sl
    use util,       only: Dirichlet,Neumann
 
    IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE> 
    number of vertical layers
    integer,  intent(in)                :: nlev
 
    time step (s)
    REALTYPE, intent(in)                :: dt
 
    local water depth (m)
    REALTYPE, intent(in)                :: depth
 
    surface and bottom
    friction velocity (m/s)
    REALTYPE, intent(in)                :: u_taus,u_taub
 
    surface and bottom
    roughness length (m)
    REALTYPE, intent(in)                :: z0s,z0b
 
    layer thickness (m)
    REALTYPE, intent(in)                :: h(0:nlev)
 
    square of shear and buoyancy
    frequency (1/s^2)
    REALTYPE, intent(in)                :: NN(0:nlev),SS(0:nlev)
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>    Original author(s): Lars Umlauf
                       (re-write after first version of
                        H. Burchard and K. Bolding
    $Log: lengthscaleeq.F90,v $
    Revision 1.8  2007-01-06 11:49:15  kbk
    namelist file extension changed .inp --&gt; .nml
    Revision 1.7  2005/11/15 11:35:02  lars
    documentation finish for print
    Revision 1.6  2005/11/03 20:53:37  hb
    Patankar trick reverted to older versions for
    stabilising 3D computations
    Revision 1.5  2005/06/27 13:44:07  kbk
    modified + removed traling blanks
    Revision 1.4  2003/03/28 09:20:35  kbk
    added new copyright to files
    Revision 1.3  2003/03/10 09:02:05  gotm
    Added new Generic Turbulence Model +
    improved documentation and cleaned up code
</PRE>

<P>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1379"
  HREF="node76.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1375"
  HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1369"
  HREF="node74.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1377"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1380"
  HREF="node76.html">The dynamic epsilon-equation (Source</A>
<B> Up:</B> <A NAME="tex2html1376"
  HREF="node48.html">Fortran: Module Interface turbulence:</A>
<B> Previous:</B> <A NAME="tex2html1370"
  HREF="node74.html">The dynamic kb-equation (Source</A>
 &nbsp; <B>  <A NAME="tex2html1378"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-01-24
</ADDRESS>
</BODY>
</HTML>
