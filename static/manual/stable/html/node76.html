<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The dynamic epsilon-equation (Source File: dissipationeq.F90)</TITLE>
<META NAME="description" CONTENT="The dynamic epsilon-equation (Source File: dissipationeq.F90)">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node77.html">
<LINK REL="previous" HREF="node75.html">
<LINK REL="up" HREF="node48.html">
<LINK REL="next" HREF="node77.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1391"
  HREF="node77.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1387"
  HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1381"
  HREF="node75.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1389"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1392"
  HREF="node77.html">The dynamic psi-equation (Source</A>
<B> Up:</B> <A NAME="tex2html1388"
  HREF="node48.html">Fortran: Module Interface turbulence:</A>
<B> Previous:</B> <A NAME="tex2html1382"
  HREF="node75.html">The dynamic q2l-equation (Source</A>
 &nbsp; <B>  <A NAME="tex2html1390"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION000572800000000000000"></A><A NAME="sec:dissipationeq"></A>
<BR>
The dynamic epsilon-equation  (Source File: dissipationeq.F90)
</H3>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>    subroutine dissipationeq(nlev,dt,u_taus,u_taub,z0s,z0b,h,NN,SS)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
The <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ k$"></SPAN>-<SPAN CLASS="MATH"><IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img37.png"
 ALT="$ \epsilon$"></SPAN> model in its form suggested by <A
 HREF="node251.html#Rodi87"><SPAN  CLASS="textit">Rodi</SPAN> (1987)</A> has been
   implemented in GOTM.
   In this model, the rate of dissipation is balanced according to
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="dissipation"></A><!-- MATH
 \begin{equation}
\dot{\epsilon}
     =
     {\cal D}_\epsilon
     + \frac{\epsilon}{k} ( c_{\epsilon 1} P + c_{\epsilon 3} G
                          - c_{\epsilon 2} \epsilon )
     \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="247" HEIGHT="45" ALIGN="MIDDLE" BORDER="0"
 SRC="img595.png"
 ALT="$\displaystyle \dot{\epsilon} = {\cal D}_\epsilon + \frac{\epsilon}{k} ( c_{\epsilon 1} P + c_{\epsilon 3} G - c_{\epsilon 2} \epsilon ) \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">163</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <!-- MATH
 $\dot{\epsilon}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="10" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img596.png"
 ALT="$ \dot{\epsilon}$"></SPAN> denotes the material derivative of <SPAN CLASS="MATH"><IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img37.png"
 ALT="$ \epsilon$"></SPAN>.
   The production terms <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img40.png"
 ALT="$ P$"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img41.png"
 ALT="$ G$"></SPAN> follow from (<A HREF="node72.html#PandG">152</A>) and
   <!-- MATH
 ${\cal D}_\epsilon$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="22" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img597.png"
 ALT="$ {\cal D}_\epsilon$"></SPAN> represents the sum of the viscous and turbulent
   transport terms.

<P>
For horizontally homogeneous flows, the transport term <!-- MATH
 ${\cal D}_\epsilon$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="22" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img597.png"
 ALT="$ {\cal D}_\epsilon$"></SPAN>
   appearing in (<A HREF="#dissipation">163</A>) is presently expressed by a simple
   gradient formulation,
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="diffusionEps"></A><!-- MATH
 \begin{equation}
{\cal D}_\epsilon = \dfrac{\partial}{\partial {z}}
      \left( \dfrac{\nu_t}{\sigma_\epsilon} \dfrac{\partial {\epsilon}}{\partial {z}} \right)
    \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="158" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img598.png"
 ALT="$\displaystyle {\cal D}_\epsilon = \dfrac{\partial}{\partial {z}} \left( \dfrac{...
...}{\sigma_\epsilon} \dfrac{\partial {\epsilon}}{\partial {z}} \right) \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">164</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <!-- MATH
 $\sigma_\epsilon$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="19" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img599.png"
 ALT="$ \sigma_\epsilon$"></SPAN> is the constant Schmidt-number for <SPAN CLASS="MATH"><IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img37.png"
 ALT="$ \epsilon$"></SPAN>.

<P>
It should be pointed out that not all authors retain the buoyancy term
   in (<A HREF="#dissipation">163</A>), see e.g. <A
 HREF="node251.html#GibsonLaunder76"><SPAN  CLASS="textit">Gibson and Launder</SPAN> (1976)</A>.  Similar to the
   model of <A
 HREF="node251.html#MellorYamada82"><SPAN  CLASS="textit">Mellor and Yamada</SPAN> (1982)</A>, <A
 HREF="node251.html#Craftetal96a"><SPAN  CLASS="textit">Craft et&nbsp;al.</SPAN> (1996)</A> set
   <!-- MATH
 $c_{\epsilon 1}=c_{\epsilon 3}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="64" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img600.png"
 ALT="$ c_{\epsilon 1}=c_{\epsilon 3}$"></SPAN>.
   However, in both cases, the <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ k$"></SPAN>-<SPAN CLASS="MATH"><IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img37.png"
 ALT="$ \epsilon$"></SPAN> model cannot
   predict a proper state of full equilibrium in stratified flows at a
   predefined value of the Richardson number (see
   <A
 HREF="node251.html#Umlaufetal2003"><SPAN  CLASS="textit">Umlauf et&nbsp;al.</SPAN> (2003)</A> and discussion around (<A HREF="node51.html#Ri_st">114</A>)). Model constants are
   summarised in table <A HREF="#tab:KE_constants">7</A>.
   <BR><P></P>
<DIV ALIGN="CENTER"><A NAME="8194"></A>
<TABLE>
<CAPTION><STRONG>Table 7:</STRONG>
 Constants appearing in
      (<A HREF="#dissipation">163</A>) and (<A HREF="node72.html#epsilon">153</A>).</CAPTION>
<TR><TD>     <DIV ALIGN="CENTER">
<TABLE CELLPADDING=3 BORDER="1" ALIGN="CENTER">
<TR><TD ALIGN="CENTER">&nbsp;</TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="19" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img468.png"
 ALT="$ c_\mu^0$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="21" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img566.png"
 ALT="$ \sigma_k$"></SPAN></TD>
<TD ALIGN="CENTER"><!-- MATH
 $\sigma_\epsilon$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="19" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img599.png"
 ALT="$ \sigma_\epsilon$"></SPAN></TD>
<TD ALIGN="CENTER"><!-- MATH
 $c_{\epsilon 1}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img601.png"
 ALT="$ c_{\epsilon 1}$"></SPAN></TD>
<TD ALIGN="CENTER"><!-- MATH
 $c_{\epsilon 2}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img602.png"
 ALT="$ c_{\epsilon 2}$"></SPAN></TD>
</TR>
<TR><TD ALIGN="CENTER"><A
 HREF="node251.html#Rodi87"><SPAN  CLASS="textit">Rodi</SPAN> (1987)</A></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="48" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img603.png"
 ALT="$ 0.5577$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img604.png"
 ALT="$ 1.0$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img605.png"
 ALT="$ 1.3$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="32" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img606.png"
 ALT="$ 1.44$"></SPAN></TD>
<TD ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="32" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img607.png"
 ALT="$ 1.92$"></SPAN></TD>
</TR>
</TABLE>
     
</DIV></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
At the end of this routine the length-scale can be constrained according to a
   suggestion of <A
 HREF="node251.html#Galperinetal88"><SPAN  CLASS="textit">Galperin et&nbsp;al.</SPAN> (1988)</A>. This feature is optional and can be activated
   by setting <TT>length_lim = .true.</TT> in <TT>gotmturb.nml</TT>.

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>    use turbulence, only: P,B,num
    use turbulence, only: tke,tkeo,k_min,eps,eps_min,L
    use turbulence, only: ce1,ce2,ce3plus,ce3minus
    use turbulence, only: cm0,cde,galp,length_lim
    use turbulence, only: epsilon_bc, psi_ubc, psi_lbc, ubc_type, lbc_type
    use turbulence, only: sig_e,sig_e0,sig_peps
    use util,       only: Dirichlet,Neumann
 
    IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE> 
    number of vertical layers
    integer,  intent(in)                :: nlev
 
    time step (s)
    REALTYPE, intent(in)                :: dt
 
    surface and bottom
    friction velocity (m/s)
    REALTYPE, intent(in)                :: u_taus,u_taub
 
    surface and bottom
    roughness length (m)
    REALTYPE, intent(in)                :: z0s,z0b
 
    layer thickness (m)
    REALTYPE, intent(in)                :: h(0:nlev)
 
    square of shear and buoyancy
    frequency (1/s^2)
    REALTYPE, intent(in)                :: NN(0:nlev),SS(0:nlev)
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>    Original author(s): Lars Umlauf
                       (re-write after first version of
                        H. Burchard and K. Bolding
 
    $Log: dissipationeq.F90,v $
    Revision 1.10  2007-01-06 11:49:15  kbk
    namelist file extension changed .inp --&gt; .nml
    Revision 1.9  2005/11/15 11:35:02  lars
    documentation finish for print
    Revision 1.8  2005/11/03 20:53:37  hb
    Patankar trick reverted to older versions for
    stabilising 3D computations
    Revision 1.7  2005/08/11 13:11:50  lars
    Added explicit loops for diffusivities for 3-D z-level support.
    Thanks to Vicente Fernandez.
    Revision 1.6  2005/06/27 13:44:07  kbk
    modified + removed traling blanks
    Revision 1.5  2003/03/28 09:20:35  kbk
    added new copyright to files
    Revision 1.4  2003/03/10 13:43:42  lars
    double definitions removed - to conform with DEC compiler
    Revision 1.3  2003/03/10 09:02:04  gotm
    Added new Generic Turbulence Model +
    improved documentation and cleaned up code
</PRE>

<P>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1391"
  HREF="node77.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1387"
  HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1381"
  HREF="node75.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1389"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1392"
  HREF="node77.html">The dynamic psi-equation (Source</A>
<B> Up:</B> <A NAME="tex2html1388"
  HREF="node48.html">Fortran: Module Interface turbulence:</A>
<B> Previous:</B> <A NAME="tex2html1382"
  HREF="node75.html">The dynamic q2l-equation (Source</A>
 &nbsp; <B>  <A NAME="tex2html1390"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-01-24
</ADDRESS>
</BODY>
</HTML>
