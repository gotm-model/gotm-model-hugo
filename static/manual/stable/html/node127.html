<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Calculate the short-wave radiation (Source File: short_wave_radiation.F90)</TITLE>
<META NAME="description" CONTENT="Calculate the short-wave radiation (Source File: short_wave_radiation.F90)">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="previous" HREF="node126.html">
<LINK REL="up" HREF="node121.html">
<LINK REL="next" HREF="node128.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html2041"
  HREF="node128.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html2037"
  HREF="node121.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html2033"
  HREF="node126.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html2039"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2042"
  HREF="node128.html">Working with observed data</A>
<B> Up:</B> <A NAME="tex2html2038"
  HREF="node121.html">Fortran: Module Interface airsea_variables</A>
<B> Previous:</B> <A NAME="tex2html2034"
  HREF="node126.html">Heat and momentum fluxes</A>
 &nbsp; <B>  <A NAME="tex2html2040"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION00063600000000000000"></A><A NAME="sec:swr"></A>
<BR>
Calculate the short-wave radiation  (Source File: short_wave_radiation.F90)
</H3>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>    subroutine short_wave_radiation(jul,secs,dlon,dlat,cloud,swr)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
This subroutine calculates the short-wave net radiation based on
    latitude, longitude, time, fractional cloud cover and albedo.
    The albedo monthly values from <A
 HREF="node251.html#Payne72"><SPAN  CLASS="textit">Payne</SPAN> (1972)</A> are given  here
    as means of the values between
    at 30<SPAN CLASS="MATH"><IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img792.png"
 ALT="$ ^{\circ}$"></SPAN> N and 40<SPAN CLASS="MATH"><IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img792.png"
 ALT="$ ^{\circ}$"></SPAN> N for the Atlantic Ocean
    (hence the same latitudinal band of the Mediterranean Sea).
    The basic formula for the short-wave radiation at the surface, <SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img793.png"
 ALT="$ Q_s$"></SPAN>,
    has been taken from <A
 HREF="node251.html#RosatiMiyacoda88"><SPAN  CLASS="textit">Rosati and Miyakoda</SPAN> (1988)</A>, who adapted the work
    of <A
 HREF="node251.html#Reed77"><SPAN  CLASS="textit">Reed</SPAN> (1977)</A> and <A
 HREF="node251.html#SimpsonPaulson99"><SPAN  CLASS="textit">Simpson and Paulson</SPAN> (1999)</A>:

<P>
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
Q_s=Q_{tot} (1-0.62 C + 0.0019 \beta) (1-\alpha),
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="282" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img794.png"
 ALT="$\displaystyle Q_s=Q_{tot} (1-0.62 C + 0.0019 \beta) (1-\alpha),$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">230</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
with the total radiation reaching the surface under clear skies,
    <SPAN CLASS="MATH"><IMG
 WIDTH="33" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img769.png"
 ALT="$ Q_{tot}$"></SPAN>, the fractional cloud cover, <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img795.png"
 ALT="$ C$"></SPAN>, the solar noon altitude,
    <SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img645.png"
 ALT="$ \beta$"></SPAN>, and the albedo, <SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img113.png"
 ALT="$ \alpha$"></SPAN>.
    This piece of code has been taken the MOM-I (Modular Ocean Model)
    version at the INGV (Istituto Nazionale di Geofisica e Vulcanologia,
    see <TT>http://www.bo.ingv.it/</TT>).

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>    use time, only: calendar_date
    IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE>    integer, intent(in)                 :: jul,secs
    REALTYPE, intent(in)                :: dlon,dlat
    REALTYPE, intent(in)                :: cloud
</PRE><EM>OUTPUT PARAMETERS:</EM>
<PRE>    REALTYPE, optional, intent(out)     :: swr
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>    Original author(s): Karsten Bolding &amp; Hans Burchard
    $Log: short_wave_radiation.F90,v $
    Revision 1.2  2010-09-17 12:53:45  jorn
    extensive code clean-up to ensure proper initialization and clean-up of all variables
    Revision 1.1  2007-09-25 10:06:10  kbk
    modularized the airsea module - added Fairall method
</PRE><I CLASS="sans">LOCAL VARIABLES:</I>
<PRE>    REALTYPE, parameter       :: pi=3.14159265358979323846
    REALTYPE, parameter       :: deg2rad=pi/180.
    REALTYPE, parameter       :: rad2deg=180./pi
 
    REALTYPE, parameter       :: solar=1350.
    REALTYPE, parameter       :: eclips=23.439*deg2rad
    REALTYPE, parameter       :: tau=0.7
    REALTYPE, parameter       :: aozone=0.09
 
    REALTYPE                  :: th0,th02,th03,sundec
    REALTYPE                  :: thsun,coszen,zen,dzen,sunbet
    REALTYPE                  :: qatten,qzer,qdir,qdiff,qtot,qshort
    REALTYPE                  :: albedo
    integer                   :: jab
    integer                   :: yy,mm,dd
    REALTYPE                  :: yrdays,days,hour,tjul
    REALTYPE                  :: rlon,rlat
 
    integer, parameter        :: yday(12) = &amp;
                  (/ 0,31,59,90,120,151,181,212,243,273,304,334 /)
 
    REALTYPE, parameter       :: alb1(20) = &amp;
                  (/.719,.656,.603,.480,.385,.300,.250,.193,.164, &amp;
                    .131,.103,.084,.071,.061,.054,.039,.036,.032,.031,.030 /)
 
    REALTYPE, parameter       :: za(20) = &amp;
                  (/90.,88.,86.,84.,82.,80.,78.,76.,74.,70.,  &amp;
                    66.,62.,58.,54.,50.,40.,30.,20.,10.,0.0 /)
 
    REALTYPE                  :: dza(19)
    data           dza/8*2.0, 6*4.0, 5*10.0/
</PRE>

<P>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html2041"
  HREF="node128.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html2037"
  HREF="node121.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html2033"
  HREF="node126.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html2039"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2042"
  HREF="node128.html">Working with observed data</A>
<B> Up:</B> <A NAME="tex2html2038"
  HREF="node121.html">Fortran: Module Interface airsea_variables</A>
<B> Previous:</B> <A NAME="tex2html2034"
  HREF="node126.html">Heat and momentum fluxes</A>
 &nbsp; <B>  <A NAME="tex2html2040"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-01-24
</ADDRESS>
</BODY>
</HTML>
