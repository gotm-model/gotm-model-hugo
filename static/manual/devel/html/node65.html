<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Boundary conditons for the psi-equation </TITLE>
<META NAME="description" CONTENT="Boundary conditons for the psi-equation ">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node66.html">
<LINK REL="previous" HREF="node64.html">
<LINK REL="up" HREF="node48.html">
<LINK REL="next" HREF="node66.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1276"
  HREF="node66.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1272"
  HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1266"
  HREF="node64.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1274"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1277"
  HREF="node66.html">Boundary conditons for the</A>
<B> Up:</B> <A NAME="tex2html1273"
  HREF="node48.html">Module turbulence: its all</A>
<B> Previous:</B> <A NAME="tex2html1267"
  HREF="node64.html">Boundary conditons for the</A>
 &nbsp; <B>  <A NAME="tex2html1275"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION000571700000000000000"></A><A NAME="sec:psiBC"></A>
<BR>
Boundary conditons for the psi-equation 
</H3>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>   REALTYPE function  psi_bc(bc,type,zi,ki,z0,u_tau)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
Computes prescribed and flux boundary conditions for  the transport
  equation (<A HREF="node77.html#generic">168</A>). The formal parameter <TT>bc</TT> determines
  whether <TT>Dirchlet</TT> or <TT>Neumann</TT>-type boundary conditions
  are computed. Depending on the physical properties of the
  boundary-layer, the parameter <TT>type</TT> relates either to a <TT>visous</TT>,
  a <TT>logarithmic</TT>, or an <TT>injection</TT>-type boundary-layer.
  In the latter case, the flux of TKE caused by breaking surface waves
  has to be specified. Presently, there is only one possibility
  to do so implemented in GOTM. It is described in section <A HREF="node95.html#sec:fkCraig">4.34</A>.
  All parameters that determine the boundary layer have to be
  set in <TT>gotmturb.nml</TT>.

<P>
Note that  in this section, for brevity, <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img20.png"
 ALT="$ z$"></SPAN> denotes the distance
  from the wall (or the surface), and <SPAN  CLASS="textit">not</SPAN> the standard
  coordinate of the same name used in GOTM.

<P>
<BR>
<BR>
  <B>Viscous boundary-layers</B>
  <BR>
<BR>

<P>
This type is not implemented yet in GOTM.

<P>
<BR>
<BR>
  <B>Logarithmic boundary-layers</B>
  <BR>
<BR>

<P>
The Dirichlet (prescribed) boundary condition follows from (<A HREF="node77.html#psi_l">167</A>) as
  <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="GE_psi_Dirichlet"></A><!-- MATH
 \begin{equation}
\psi = (c_\mu^0)^p \kappa^n k^m \left( z+z_0 \right)^n
    \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="203" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img551.png"
 ALT="$\displaystyle \psi = (c_\mu^0)^p \kappa^n k^m \left( z+z_0 \right)^n \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">140</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where we used the law-of-the-wall relation <!-- MATH
 $l=\kappa(z+z_0)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="94" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img546.png"
 ALT="$ l=\kappa(z+z_0)$"></SPAN>.

<P>
Neumann (flux) boundary condition can be written as
  <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="GE_psi_Neumann"></A><!-- MATH
 \begin{equation}
F_\psi = - \dfrac{\nu_t}{\sigma_\psi} \dfrac{\partial {\psi}}{\partial {z}} =
    - \dfrac{ n (c_\mu^0)^{p+1} \kappa^{n+1}}{\sigma_\psi} k^{m+\frac{1}{2}} (z+z_0)^n
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="339" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="img552.png"
 ALT="$\displaystyle F_\psi = - \dfrac{\nu_t}{\sigma_\psi} \dfrac{\partial {\psi}}{\pa...
...dfrac{ n (c_\mu^0)^{p+1} \kappa^{n+1}}{\sigma_\psi} k^{m+\frac{1}{2}} (z+z_0)^n$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">141</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
by inserting <!-- MATH
 $l=\kappa(z+z_0)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="94" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img546.png"
 ALT="$ l=\kappa(z+z_0)$"></SPAN> into the expression for the
  diffusivity in (<A HREF="node37.html#nu">46</A>). Note, that in (<A HREF="#GE_psi_Dirichlet">140</A>) and
  (<A HREF="#GE_psi_Neumann">141</A>), we use <TT>ki</TT>, the value of <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ k$"></SPAN> at the current time
  step, to compute the boundary conditions. By means of
  (<A HREF="node51.html#kLog">103</A>), it would have been also possible to express the boundary
  conditions in terms of the friction velocity, <SPAN CLASS="MATH"><IMG
 WIDTH="20" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img548.png"
 ALT="$ u_*$"></SPAN>. This, however,
  causes numerical difficulties in case of a stress-free surface
  boundary-layer as for example in the pressure-driven open channel
  flow.

<P>
<BR>
<BR>
  <B>Shear-free boundary-layers with injection of TKE</B>
  <BR>
<BR>

<P>
The Dirichlet (prescribed) boundary condition follows simply
  from the power-law (<A HREF="node51.html#power_law">110</A>) inserted in (<A HREF="node77.html#psi_l">167</A>). This
  yields
  <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="GE_psi_wave_Dirichlet"></A><!-- MATH
 \begin{equation}
\psi= (c_\mu^0)^p K^m  L^n (z+z_0)^{m \alpha + n}
    \quad .
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="230" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img553.png"
 ALT="$\displaystyle \psi= (c_\mu^0)^p K^m L^n (z+z_0)^{m \alpha + n} \quad .$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">142</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
The Neumann (flux) boundary condition is
  <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="GE_psi_wave_Neumann"></A><!-- MATH
 \begin{equation}
F_\psi = - \dfrac{\nu_t}{\sigma_\psi} \dfrac{\partial {\psi}}{\partial {z}} =
    - \dfrac{c_\mu (c_\mu^0)^p}{\sigma_\psi} \left(m\alpha + n  \right)
       K^{m+\frac{1}{2}} L^{n+1}
   (z+z_0)^{(m+\frac{1}{2})\alpha+n}
   \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="490" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="img554.png"
 ALT="$\displaystyle F_\psi = - \dfrac{\nu_t}{\sigma_\psi} \dfrac{\partial {\psi}}{\pa...
... \right) K^{m+\frac{1}{2}} L^{n+1} (z+z_0)^{(m+\frac{1}{2})\alpha+n} \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">143</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>   IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE>   integer, intent(in)                 :: bc,type
   REALTYPE, intent(in)                :: zi,ki,z0,u_tau
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>   Original author(s): Lars Umlauf
</PRE>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1276"
  HREF="node66.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1272"
  HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1266"
  HREF="node64.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1274"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1277"
  HREF="node66.html">Boundary conditons for the</A>
<B> Up:</B> <A NAME="tex2html1273"
  HREF="node48.html">Module turbulence: its all</A>
<B> Previous:</B> <A NAME="tex2html1267"
  HREF="node64.html">Boundary conditons for the</A>
 &nbsp; <B>  <A NAME="tex2html1275"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-12-28
</ADDRESS>
</BODY>
</HTML>
