<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Heat and momentum fluxes according to Fairall et al.</TITLE>
<META NAME="description" CONTENT="Heat and momentum fluxes according to Fairall et al.">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node127.html">
<LINK REL="previous" HREF="node125.html">
<LINK REL="up" HREF="node104.html">
<LINK REL="next" HREF="node127.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html2043"
  HREF="node127.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html2039"
  HREF="node104.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html2033"
  HREF="node125.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html2041"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2044"
  HREF="node127.html">Calculate the short-wave radiation</A>
<B> Up:</B> <A NAME="tex2html2040"
  HREF="node104.html">Air-Sea interaction</A>
<B> Previous:</B> <A NAME="tex2html2034"
  HREF="node125.html">Heat and momemtum fluxes</A>
 &nbsp; <B>  <A NAME="tex2html2042"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00068000000000000000">
Heat and momentum fluxes according to Fairall et al.</A>
</H2>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>   subroutine fairall(sst,airt,u10,v10,precip,evap,taux,tauy,qe,qh)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
The surface momentum flux vector, <!-- MATH
 $(\tau_x^s,\tau_y^s)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="54" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img779.png"
 ALT="$ (\tau_x^s,\tau_y^s)$"></SPAN>,
   in [Nm<SPAN CLASS="MATH"><IMG
 WIDTH="21" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img88.png"
 ALT="$ ^{-2}$"></SPAN>],
   the latent heat flux, <SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img781.png"
 ALT="$ Q_e$"></SPAN>,
   and the sensible heat flux, <SPAN CLASS="MATH"><IMG
 WIDTH="25" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img783.png"
 ALT="$ Q_h$"></SPAN>, both in [Wm<SPAN CLASS="MATH"><IMG
 WIDTH="21" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img88.png"
 ALT="$ ^{-2}$"></SPAN>]
   are calculated here according to the <A
 HREF="node251.html#Fairalletal96a"><SPAN  CLASS="textit">Fairall et&nbsp;al.</SPAN> (1996b)</A> bulk
   formulae, which are build on the Liu-Katsaros-Businger
   (<A
 HREF="node251.html#Liuetal79"><SPAN  CLASS="textit">Liu et&nbsp;al.</SPAN> (1979)</A>) method.
   Cool skin and warm layer effects are considered according to the
   suggestions of <A
 HREF="node251.html#Fairalletal96b"><SPAN  CLASS="textit">Fairall et&nbsp;al.</SPAN> (1996a)</A>.

<P>
The air temperature <TT>airt</TT> and the sea surface temperature
   <TT>sst</TT> may be given in Kelvin or Celcius:
   if they are <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img795.png"
 ALT="$ &gt;$"></SPAN> 100 - Kelvin is assumed.

<P>
This piece of code has been adapted from the COARE code originally
   written by David Rutgers and Frank Bradley - see
   http://www.coaps.fsu.edu/COARE/flux_algor/flux.html.

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>   use airsea_variables, only: kelvin,const06,rgas,rho_0,g,rho_0,kappa
   use airsea_variables, only: qs,qa,rhoa
   use airsea_variables, only: cpa,cpw
   use airsea, only: rain_impact,calc_evaporation
   IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE>   REALTYPE, intent(in)                :: sst,airt,u10,v10,precip
</PRE><EM>INPUT/OUTPUT PARAMETERS:</EM>
<PRE>   REALTYPE, intent(inout)             :: evap
</PRE><EM>OUTPUT PARAMETERS:</EM>
<PRE>   REALTYPE, intent(out)               :: taux,tauy,qe,qh
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>   Original author(s): Adolf Stips
</PRE><I CLASS="sans">DEFINED PARAMETERS:</I>
<PRE>   Fairall LKB roughness Reynolds number to Von Karman
   REALTYPE,parameter        :: fdg = 1.0            non-dimensional
 
   Beta parameter evaluated from Fairall low windspeed turbulence data.
   REALTYPE,parameter        :: beta = 1.2           non-dimensional
 
   Zabl      Height (m) of atmospheric boundary layer.
   REALTYPE,parameter        :: Zabl = 600.0         in [m]
 
   REALTYPE, parameter       :: r3 = 1.0/3.0
   Liu et al. (1979) look-up table coefficients to compute roughness
   Reynolds number for temperature (rt) and moisture (rq) as a
   function of wind Reynolds number (rr):
        rt = Liu_a(:,1) * Rr   ** Liu_b(:,1)    temperature
        rq = Liu_a(:,2) * Rr   ** Liu_b(:,2)    moisture
   REALTYPE,parameter, dimension(8,2) :: Liu_a = reshape ( &amp;
                 (/ 0.177,  1.376,    1.026,      1.625,   &amp;
                    4.661, 34.904, 1667.190, 588000.0,     &amp;
                    0.292,  1.808,    1.393,      1.956,   &amp;
                    4.994, 30.709, 1448.680, 298000.0 /),  &amp;
                 (/ 8, 2 /) )
 
   REALTYPE,parameter, dimension(8,2) :: Liu_b = reshape ( &amp;
                 (/  0.0,    0.929, -0.599, -1.018,        &amp;
                    -1.475, -2.067, -2.907, -3.935,        &amp;
                     0.0,    0.826, -0.528, -0.870,        &amp;
                    -1.297, -1.845, -2.682, -3.616 /),     &amp;
                 (/ 8, 2 /) )
 
   REALTYPE,parameter, dimension(9) :: Liu_Rr =            &amp;
                 (/    0.0,  0.11,   0.825,   3.0,         &amp;
                      10.0, 30.0,  100.0,   300.0,         &amp;
                    1000.0 /)
   Height (m) of surface air temperature measurement.
   REALTYPE, parameter       ::  zt= 2.0
   Height (m) of surface air humidity measurement
   REALTYPE, parameter       ::  zq= 2.0
   Height (m) of surface winds measurement
   REALTYPE, parameter       ::  zw= 10.0
   integer,  parameter       :: itermax = 20
 ifdef GUSTINESS
   REALTYPE, parameter       :: wgust=0.2
 else
   REALTYPE, parameter       :: wgust=0.0
 endif
 
   REALTYPE,external         :: psi
</PRE><I CLASS="sans">LOCAL VARIABLES:</I>
<PRE>   REALTYPE                  :: tmp,cff,wgus
   REALTYPE                  :: L
   REALTYPE                  :: Cd
   REALTYPE                  :: ta,ta_k,tw,tw_k
   integer                   :: ier,iter,k
   REALTYPE                  :: vis_air
   REALTYPE                  :: tpsi,qpsi,wpsi,ZWoL,oL,ZToL,ZQoL,ZoW,ZoT, ZoQ
   REALTYPE                  :: Wstar,Tstar, Qstar, delQ, delT, rr,rt,rq
   REALTYPE                  :: TVstar,Bf, upvel,delw,Wspeed, w
   REALTYPE                  :: ri,cd_rain
   REALTYPE                  :: x1,x2,x3
   REALTYPE                  :: x
   REALTYPE                  :: rainfall
   REALTYPE, parameter       :: eps=1.0e-12
</PRE>

<P>

<P>

<BR><HR>
<ADDRESS>
Karsten Bolding
2012-12-28
</ADDRESS>
</BODY>
</HTML>
