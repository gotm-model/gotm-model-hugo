<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The buoyancy equation</TITLE>
<META NAME="description" CONTENT="The buoyancy equation">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node33.html">
<LINK REL="previous" HREF="node31.html">
<LINK REL="up" HREF="node15.html">
<LINK REL="next" HREF="node33.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html792"
  HREF="node33.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html788"
  HREF="node15.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html782"
  HREF="node31.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html790"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html793"
  HREF="node33.html">Calculation of the vertical</A>
<B> Up:</B> <A NAME="tex2html789"
  HREF="node15.html">The mean flow model</A>
<B> Previous:</B> <A NAME="tex2html783"
  HREF="node31.html">The salinity equation</A>
 &nbsp; <B>  <A NAME="tex2html791"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION000412000000000000000">
The buoyancy equation</A>
</H2>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>   subroutine buoyancy(nlev,dt,cnpar,nub,gamb)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
This subroutine solves a transport equation for the mean
   potential buoyancy,
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="DefBuoyancy"></A><!-- MATH
 \begin{equation}
B=-g\frac{ {\langle \rho \rangle} -\rho_0}{\rho_0}
     \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="142" HEIGHT="55" ALIGN="MIDDLE" BORDER="0"
 SRC="img141.png"
 ALT="$\displaystyle B=-g\frac{ {\langle \rho \rangle} -\rho_0}{\rho_0} \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">33</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img142.png"
 ALT="$ g$"></SPAN> is the accelaration of gravity, and <!-- MATH
 ${\langle \rho \rangle}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img89.png"
 ALT="$ {\langle \rho \rangle} $"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="19" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img143.png"
 ALT="$ \rho_0$"></SPAN>
   are the mean potential density and the reference density, respectively.
   A simplified transport equation for <SPAN CLASS="MATH"><IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img14.png"
 ALT="$ B$"></SPAN> can be written as
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="bEq"></A><!-- MATH
 \begin{equation}
\dot{B}
     = {\cal D}_B
     \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="86" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img144.png"
 ALT="$\displaystyle \dot{B} = {\cal D}_B \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">34</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <SPAN CLASS="MATH"><IMG
 WIDTH="17" HEIGHT="21" ALIGN="BOTTOM" BORDER="0"
 SRC="img145.png"
 ALT="$ \dot{B}$"></SPAN> denotes the material derivative of <SPAN CLASS="MATH"><IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img14.png"
 ALT="$ B$"></SPAN>, and
   <!-- MATH
 ${\cal D}_b$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="22" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img146.png"
 ALT="$ {\cal D}_b$"></SPAN> is the sum of the turbulent and viscous transport
   terms modelled according to
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="Db"></A><!-- MATH
 \begin{equation}
{\cal D}_B
     = \dfrac{\partial}{\partial {z}}
      \left( (\nu^B_t+\nu^B) \dfrac{\partial {B}}{\partial {z}} - \tilde{\Gamma}_B \right)
     \quad .
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="256" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img147.png"
 ALT="$\displaystyle {\cal D}_B = \dfrac{\partial}{\partial {z}} \left( (\nu^B_t+\nu^B) \dfrac{\partial {B}}{\partial {z}} - \tilde{\Gamma}_B \right) \quad .$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">35</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
In this equation, <SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img148.png"
 ALT="$ \nu^B_t$"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="24" HEIGHT="20" ALIGN="BOTTOM" BORDER="0"
 SRC="img149.png"
 ALT="$ \nu^B$"></SPAN> are the turbulent and molecular
   diffusivities of buoyancy, respectively, and <!-- MATH
 $\tilde{\Gamma}_B$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="25" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img150.png"
 ALT="$ \tilde{\Gamma}_B$"></SPAN>
   denotes the non-local flux of buoyancy, see
   section <A HREF="node36.html#sec:turbulenceIntro">4</A>. In the current version of GOTM,
   we set <!-- MATH
 $\nu^B_t = \nu^\Theta_t$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="64" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img151.png"
 ALT="$ \nu^B_t = \nu^\Theta_t$"></SPAN> for simplicity. Source and sink
   terms are completely disregarded, and thus (<A HREF="#bEq">34</A>) mainly serves
   as a convenient tool for some idealized test cases in
   GOTM.

<P>
Diffusion is treated implicitly in space (see equations (<A HREF="node18.html#sigmafirst">7</A>)-
   (<A HREF="node18.html#sigmalast">9</A>)), and then solved by a
   simplified Gauss elimination.
   Vertical advection is included, and it must be non-conservative,
   which is ensured by setting the local variable <TT>adv_mode=0</TT>,
   see section <A HREF="node174.html#sec:advectionMean">8.5</A> on page <A HREF="node174.html#sec:advectionMean"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="/usr/share/latex2html/icons/crossref.png"></A>.

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>   use meanflow,      only: h,w,buoy,T,avh,init_buoyancy
   use meanflow,      only: w_grid,grid_method
   use observations,  only: b_obs_NN,b_obs_surf,b_obs_sbf
   use observations,  only: w_adv_discr,w_adv_method
   use util,          only: Dirichlet,Neumann
   use util,          only: oneSided,zeroDivergence
   IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE>   number of vertical layers
   integer, intent(in)                 :: nlev
 
    time step (s)
   REALTYPE, intent(in)                :: dt
 
   numerical "implicitness" parameter
   REALTYPE, intent(in)                :: cnpar
 
   diffusivity of buoyancy (m^2/s)
   REALTYPE, intent(in)                :: nub(0:nlev)
 
   non-local buoyancy flux (m^2/s^3)
   REALTYPE, intent(in)                :: gamb(0:nlev)
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>   Original author(s): Hans Burchard &amp; Karsten Bolding
</PRE>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html792"
  HREF="node33.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html788"
  HREF="node15.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html782"
  HREF="node31.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html790"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html793"
  HREF="node33.html">Calculation of the vertical</A>
<B> Up:</B> <A NAME="tex2html789"
  HREF="node15.html">The mean flow model</A>
<B> Previous:</B> <A NAME="tex2html783"
  HREF="node31.html">The salinity equation</A>
 &nbsp; <B>  <A NAME="tex2html791"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-12-28
</ADDRESS>
</BODY>
</HTML>
