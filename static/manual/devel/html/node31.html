<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The salinity equation </TITLE>
<META NAME="description" CONTENT="The salinity equation ">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node32.html">
<LINK REL="previous" HREF="node30.html">
<LINK REL="up" HREF="node15.html">
<LINK REL="next" HREF="node32.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html780"
  HREF="node32.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html776"
  HREF="node15.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html770"
  HREF="node30.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html778"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html781"
  HREF="node32.html">The buoyancy equation</A>
<B> Up:</B> <A NAME="tex2html777"
  HREF="node15.html">The mean flow model</A>
<B> Previous:</B> <A NAME="tex2html771"
  HREF="node30.html">The temperature equation</A>
 &nbsp; <B>  <A NAME="tex2html779"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION000411000000000000000"></A><A NAME="sec:salinity"></A>
<BR>
The salinity equation 
</H2>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>   subroutine salinity(nlev,dt,cnpar,nus,gams)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
This subroutine computes the balance of salinity in the form
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="SEq"></A><!-- MATH
 \begin{equation}
\dot{S}
     = {\cal D}_S
     - \frac{1}{\tau^S_R}(S-S_{obs})
     \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="194" HEIGHT="50" ALIGN="MIDDLE" BORDER="0"
 SRC="img128.png"
 ALT="$\displaystyle \dot{S} = {\cal D}_S - \frac{1}{\tau^S_R}(S-S_{obs}) \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">30</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="21" ALIGN="BOTTOM" BORDER="0"
 SRC="img129.png"
 ALT="$ \dot{S}$"></SPAN> denotes the material derivative of the salinity <SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img15.png"
 ALT="$ S$"></SPAN>, and
   <!-- MATH
 ${\cal D}_S$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="25" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img130.png"
 ALT="$ {\cal D}_S$"></SPAN> is the sum of the turbulent and viscous transport
   terms modelled according to
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="DS"></A><!-- MATH
 \begin{equation}
{\cal D}_S
     = \dfrac{\partial}{\partial {z}}
      \left(
         \left( \nu^S_t + \nu^S \right) \dfrac{\partial {S}}{\partial {z}} - \tilde{\Gamma}_S
         \right)
     \quad .
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="252" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img131.png"
 ALT="$\displaystyle {\cal D}_S = \dfrac{\partial}{\partial {z}} \left( \left( \nu^S_t...
...S \right) \dfrac{\partial {S}}{\partial {z}} - \tilde{\Gamma}_S \right) \quad .$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">31</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
In this equation, <SPAN CLASS="MATH"><IMG
 WIDTH="22" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \nu^S_t$"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="22" HEIGHT="20" ALIGN="BOTTOM" BORDER="0"
 SRC="img133.png"
 ALT="$ \nu^S$"></SPAN> are the turbulent and
   molecular diffusivities of salinity, respectively,
   and <!-- MATH
 $\tilde{\Gamma}_S$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img134.png"
 ALT="$ \tilde{\Gamma}_S$"></SPAN>
   denotes the non-local flux of salinity, see
   section <A HREF="node36.html#sec:turbulenceIntro">4</A>. In the current version of GOTM,
   we set <!-- MATH
 $\nu^S_t = \nu^\Theta_t$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="62" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$ \nu^S_t = \nu^\Theta_t$"></SPAN> for simplicity.

<P>
Horizontal advection is optionally
   included  (see <TT>obs.nml</TT>) by means of prescribed
   horizontal gradients <!-- MATH
 $\partial_xS$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="31" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img94.png"
 ALT="$ \partial_xS$"></SPAN> and <!-- MATH
 $\partial_yS$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="30" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img95.png"
 ALT="$ \partial_yS$"></SPAN> and
   calculated horizontal mean velocities <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img11.png"
 ALT="$ U$"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="17" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img12.png"
 ALT="$ V$"></SPAN>.
   Relaxation with the time scale <SPAN CLASS="MATH"><IMG
 WIDTH="22" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img136.png"
 ALT="$ \tau^S_R$"></SPAN>
   towards a precribed (changing in time)
   profile <SPAN CLASS="MATH"><IMG
 WIDTH="32" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img137.png"
 ALT="$ S_{obs}$"></SPAN> is possible.

<P>
Inner sources or sinks are not considered.
   The surface freshwater flux is given by means of the precipitation
   - evaporation data read in as <SPAN CLASS="MATH"><IMG
 WIDTH="48" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img138.png"
 ALT="$ P-E$"></SPAN> through the <TT>airsea.nml</TT> namelist:
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="S_sbc"></A><!-- MATH
 \begin{equation}
{\cal D}_S =  S (P-E),
     \qquad \mbox{at } z=\zeta,
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="118" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img139.png"
 ALT="$\displaystyle {\cal D}_S = S (P-E),$">&nbsp; &nbsp;at <IMG
 WIDTH="46" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img140.png"
 ALT="$\displaystyle z=\zeta,$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">32</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
with <SPAN CLASS="MATH"><IMG
 WIDTH="48" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img138.png"
 ALT="$ P-E$"></SPAN> given as a velocity (note that <!-- MATH
 ${\cal D}_S$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="25" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img130.png"
 ALT="$ {\cal D}_S$"></SPAN> is the flux in the
   direction of <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img20.png"
 ALT="$ z$"></SPAN>, and thus positive for a <SPAN  CLASS="textit">loss</SPAN> of salinity) .
   Diffusion is numerically treated implicitly,
   see equations (<A HREF="node18.html#sigmafirst">7</A>)-(<A HREF="node18.html#sigmalast">9</A>).
   The tri-diagonal matrix is solved then by a simplified Gauss elimination.
   Vertical advection is included, and it must be non-conservative,
   which is ensured by setting the local variable <TT>adv_mode=0</TT>,
   see section <A HREF="node174.html#sec:advectionMean">8.5</A> on page <A HREF="node174.html#sec:advectionMean"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="/usr/share/latex2html/icons/crossref.png"></A>.

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>   use meanflow,     only: avmols
   use meanflow,     only: h,u,v,w,S,avh
   use observations, only: dsdx,dsdy,s_adv
   use observations, only: w_adv_discr,w_adv_method
   use observations, only: sprof,SRelaxTau
   use airsea,       only: precip,evap
   use util,         only: Dirichlet,Neumann
   use util,         only: oneSided,zeroDivergence
 
   IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE> 
   number of vertical layers
   integer, intent(in)                 :: nlev
 
    time step (s)
   REALTYPE, intent(in)                :: dt
 
   numerical "implicitness" parameter
   REALTYPE, intent(in)                :: cnpar
 
   diffusivity of salinity (m^2/s)
   REALTYPE, intent(in)                :: nus(0:nlev)
 
   non-local salinity flux (psu m/s)
   REALTYPE, intent(in)                :: gams(0:nlev)
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>   Original author(s): Hans Burchard &amp; Karsten Bolding
</PRE>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html780"
  HREF="node32.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html776"
  HREF="node15.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html770"
  HREF="node30.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html778"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html781"
  HREF="node32.html">The buoyancy equation</A>
<B> Up:</B> <A NAME="tex2html777"
  HREF="node15.html">The mean flow model</A>
<B> Previous:</B> <A NAME="tex2html771"
  HREF="node30.html">The temperature equation</A>
 &nbsp; <B>  <A NAME="tex2html779"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-12-28
</ADDRESS>
</BODY>
</HTML>
