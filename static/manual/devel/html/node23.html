<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The vertical grid </TITLE>
<META NAME="description" CONTENT="The vertical grid ">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node24.html">
<LINK REL="previous" HREF="node19.html">
<LINK REL="up" HREF="node15.html">
<LINK REL="next" HREF="node24.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html684"
  HREF="node24.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html680"
  HREF="node15.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html674"
  HREF="node22.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html682"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html685"
  HREF="node24.html">The Coriolis rotation</A>
<B> Up:</B> <A NAME="tex2html681"
  HREF="node15.html">The mean flow model</A>
<B> Previous:</B> <A NAME="tex2html675"
  HREF="node22.html">Print the current state</A>
 &nbsp; <B>  <A NAME="tex2html683"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00043000000000000000"></A><A NAME="sec:updategrid"></A>
<BR>
The vertical grid 
</H2>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>   subroutine updategrid(nlev,dt,zeta)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
This subroutine calculates for each time step new layer thicknesses
   in order to fit them to the changing water depth.
   Three different grids can be specified:
   
<OL>
<LI>Equidistant grid with possible zooming towards surface and bottom.
   The number of layers, <TT>nlev</TT>, and the zooming factors,
   <TT>ddu</TT>=<SPAN CLASS="MATH"><IMG
 WIDTH="20" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img61.png"
 ALT="$ d_u$"></SPAN> and  <TT>ddl</TT>=<SPAN CLASS="MATH"><IMG
 WIDTH="17" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img62.png"
 ALT="$ d_l$"></SPAN>,
   are specified in <TT>gotmmean.nml</TT>.
   Zooming is applied according to the formula
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="formula_Antoine"></A><!-- MATH
 \begin{equation}
h_k = D\frac{\mbox{tanh}\left( (d_l+d_u)\frac{k}{M}-d_l\right)
     +\mbox{tanh}(d_l)}{\mbox{tanh}(d_l)+\mbox{tanh}(d_u)}-1
    \quad .
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="344" HEIGHT="61" ALIGN="MIDDLE" BORDER="0"
 SRC="img63.png"
 ALT="$\displaystyle h_k = D\frac{\mbox{tanh}\left( (d_l+d_u)\frac{k}{M}-d_l\right) +\mbox{tanh}(d_l)}{\mbox{tanh}(d_l)+\mbox{tanh}(d_u)}-1 \quad .$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">11</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
From this formula, the following grids are constructed:
   
<UL>
<LI><SPAN CLASS="MATH"><IMG
 WIDTH="84" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img64.png"
 ALT="$ d_l=d_u=0$"></SPAN> results in equidistant discretisations.
</LI>
<LI><!-- MATH
 $d_l>0, d_u=0$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="99" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img65.png"
 ALT="$ d_l&gt;0, d_u=0$"></SPAN> results in zooming near the bottom.
</LI>
<LI><!-- MATH
 $d_l=0, d_u>0$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="99" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img66.png"
 ALT="$ d_l=0, d_u&gt;0$"></SPAN> results in zooming near the surface.
</LI>
<LI><!-- MATH
 $d_l>0, d_u>0$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="99" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img67.png"
 ALT="$ d_l&gt;0, d_u&gt;0$"></SPAN> results in double zooming nea both,
           the surface and the bottom.
   
</LI>
</UL>

<P>
</LI>
<LI>Sigma-layers. The fraction that every layer occupies is
   read-in from file, see <TT>gotmmean.nml</TT>.
</LI>
<LI>Cartesian layers. The height of every layer is read in from file,
   see <TT>gotmmean.nml</TT>.
   This method is not recommended when a varying sea surface is considered.
   
</LI>
</OL>

<P>
Furthermore, vertical velocity profiles are calculated here, if
   <TT>w_adv_method</TT> is 1 or 2, which has to be chosen in the
   <TT>w_advspec</TT> namelist in <TT>obs.nml</TT>. The profiles of vertical
   velocity are determined by two values,
   the height of maximum absolute value of vertical velocity, <TT>w_height</TT>,
   and the vertical velocity at this height, <TT>w_adv</TT>. From <TT>w_height</TT>,
   the vertical velocity is linearly decreasing towards the surface and
   the bottom, where is value is zero.

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>   use meanflow,     only: grid_ready
   use meanflow,     only: depth0,depth
   use meanflow,     only: ga,z,h,ho,ddu,ddl,grid_method
   use meanflow,     only: NN,SS,w_grid,grid_file,w
   use observations, only: zeta_method,w_adv_method
   use observations, only: w_adv,w_height,w_adv_discr
   IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE>   integer, intent(in)                 :: nlev
   REALTYPE, intent(in)                :: dt,zeta
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>   Original author(s): Hans Burchard &amp; Karsten Bolding
</PRE>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html684"
  HREF="node24.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html680"
  HREF="node15.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html674"
  HREF="node22.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html682"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html685"
  HREF="node24.html">The Coriolis rotation</A>
<B> Up:</B> <A NAME="tex2html681"
  HREF="node15.html">The mean flow model</A>
<B> Previous:</B> <A NAME="tex2html675"
  HREF="node22.html">Print the current state</A>
 &nbsp; <B>  <A NAME="tex2html683"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-12-28
</ADDRESS>
</BODY>
</HTML>
