<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Diffusion schemes -- grid centers</TITLE>
<META NAME="description" CONTENT="Diffusion schemes -- grid centers">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node173.html">
<LINK REL="previous" HREF="node171.html">
<LINK REL="up" HREF="node169.html">
<LINK REL="next" HREF="node173.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html2699"
  HREF="node173.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html2695"
  HREF="node169.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html2689"
  HREF="node171.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html2697"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2700"
  HREF="node173.html">Diffusion schemes  </A>
<B> Up:</B> <A NAME="tex2html2696"
  HREF="node169.html">Utilities</A>
<B> Previous:</B> <A NAME="tex2html2690"
  HREF="node171.html">Module util  </A>
 &nbsp; <B>  <A NAME="tex2html2698"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00093000000000000000"></A><A NAME="sec:diffusionMean"></A>
<BR>
Diffusion schemes -- grid centers
</H2>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>   subroutine diff_center(N,dt,cnpar,posconc,h,Bcup,Bcdw, &amp;
                          Yup,Ydw,nuY,Lsour,Qsour,Taur,Yobs,Y)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
This subroutine solves the one-dimensional diffusion equation
  including source terms,
   <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="YdiffCenter"></A><!-- MATH
 \begin{equation}
\dfrac{\partial {Y}}{\partial {t}}
     = \dfrac{\partial {}}{\partial {z}} \left( \nu_Y \dfrac{\partial {Y}}{\partial {z}} \right)
     - \frac{1}{\tau_R}(Y-Y_{obs})
     + Y L_{\text{sour}} + Q_{\text{sour}}
     \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="404" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img800.png"
 ALT="$\displaystyle \dfrac{\partial {Y}}{\partial {t}} = \dfrac{\partial {}}{\partial...
... - \frac{1}{\tau_R}(Y-Y_{obs}) + Y L_{\text{sour}} + Q_{\text{sour}} \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">233</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
for al variables defined at the centers of the grid cells, and
  a diffusion coefficient <SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img801.png"
 ALT="$ \nu_Y$"></SPAN> defined at the faces.
  Relaxation with time scale <SPAN CLASS="MATH"><IMG
 WIDTH="21" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img802.png"
 ALT="$ \tau_R$"></SPAN> towards observed values
  <!-- MATH
 $Y_{\text{obs}}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="32" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img803.png"
 ALT="$ Y_{\text{obs}}$"></SPAN> is possible. <!-- MATH
 $L_{\text{sour}}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="39" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img804.png"
 ALT="$ L_{\text{sour}}$"></SPAN> specifies a
  linear source term, and <!-- MATH
 $Q_{\text{sour}}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="40" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img805.png"
 ALT="$ Q_{\text{sour}}$"></SPAN> a constant source term.
  Central differences are used to discretize the problem
  as discussed in section <A HREF="node18.html#SectionNumericsMean">3.1.2</A>. The diffusion term,
  the linear source term, and the linear part arising from the
  relaxation term are treated
  with an implicit method, whereas the constant source term is treated
  fully explicit.

<P>
The input parameters <TT>Bcup</TT> and <TT>Bcdw</TT> specify the type
  of the upper and lower boundary conditions, which can be either
  Dirichlet or Neumann-type. <TT>Bcup</TT> and <TT>Bcdw</TT> must have integer
  values corresponding to the parameters <TT>Dirichlet</TT> and <TT>Neumann</TT>
  defined in the module <TT>util</TT>, see section <A HREF="node171.html#sec:utils">8.2</A>.
  <TT>Yup</TT> and <TT>Ydw</TT> are the values of the boundary conditions at
  the surface and the bottom. Depending on the values of <TT>Bcup</TT> and
  <TT>Bcdw</TT>, they represent either fluxes or prescribed values.
  The integer <TT>posconc</TT> indicates if a quantity is
  non-negative by definition (<TT>posconc</TT>=1, such as for concentrations)
  or not (<TT>posconc</TT>=0). For <TT>posconc</TT>=1 and negative
  boundary fluxes, the source term linearisation according to
  <A
 HREF="node251.html#Patankar80"><SPAN  CLASS="textit">Patankar</SPAN> (1980)</A> is applied.

<P>
Note that fluxes <SPAN  CLASS="textit">entering</SPAN> a boundary cell are counted positive
  by convention. The lower and upper position for prescribing these fluxes
  are located at the lowest und uppermost grid faces with index "0" and
  index "N", respectively. If values are prescribed, they are located at
  the centers with index "1" and index "N", respectively.

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>   use util,          only  : Dirichlet, Neumann
   use mtridiagonal
 
   IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE> 
   number of vertical layers
   integer,  intent(in)                :: N
 
   time step (s)
   REALTYPE, intent(in)                :: dt
 
   "implicitness" parameter
   REALTYPE, intent(in)                :: cnpar
 
   1: non-negative concentration, 0: else
   integer, intent(in)                 :: posconc
 
   layer thickness (m)
   REALTYPE, intent(in)                :: h(0:N)
 
   type of upper BC
   integer,  intent(in)                :: Bcup
 
   type of lower BC
   integer,  intent(in)                :: Bcdw
 
   value of upper BC
   REALTYPE, intent(in)                :: Yup
 
   value of lower BC
   REALTYPE, intent(in)                :: Ydw
 
   diffusivity of Y
   REALTYPE, intent(in)                :: nuY(0:N)
 
   linear source term
   (treated implicitly)
   REALTYPE, intent(in)                :: Lsour(0:N)
 
   constant source term
   (treated explicitly)
   REALTYPE, intent(in)                :: Qsour(0:N)
 
   relaxation time (s)
   REALTYPE, intent(in)                :: Taur(0:N)
 
   observed value of Y
   REALTYPE, intent(in)                :: Yobs(0:N)
</PRE><EM>INPUT/OUTPUT PARAMETERS:</EM>
<PRE>   REALTYPE                            :: Y(0:N)
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>   Original author(s): Lars Umlauf
</PRE>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html2699"
  HREF="node173.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html2695"
  HREF="node169.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html2689"
  HREF="node171.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html2697"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2700"
  HREF="node173.html">Diffusion schemes  </A>
<B> Up:</B> <A NAME="tex2html2696"
  HREF="node169.html">Utilities</A>
<B> Previous:</B> <A NAME="tex2html2690"
  HREF="node171.html">Module util  </A>
 &nbsp; <B>  <A NAME="tex2html2698"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-12-28
</ADDRESS>
</BODY>
</HTML>
