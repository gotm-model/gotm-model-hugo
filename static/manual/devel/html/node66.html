<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Boundary conditons for the q2l-equation</TITLE>
<META NAME="description" CONTENT="Boundary conditons for the q2l-equation">
<META NAME="keywords" CONTENT="html">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="html.css">

<LINK REL="next" HREF="node67.html">
<LINK REL="previous" HREF="node65.html">
<LINK REL="up" HREF="node48.html">
<LINK REL="next" HREF="node67.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1288"
  HREF="node67.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1284"
  HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1278"
  HREF="node65.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1286"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1289"
  HREF="node67.html">Clean up the turbulence</A>
<B> Up:</B> <A NAME="tex2html1285"
  HREF="node48.html">Module turbulence: its all</A>
<B> Previous:</B> <A NAME="tex2html1279"
  HREF="node65.html">Boundary conditons for the</A>
 &nbsp; <B>  <A NAME="tex2html1287"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION000571800000000000000"></A><A NAME="sec:q2lBC"></A>
<BR>
Boundary conditons for the q2l-equation
</H3>

<P>

<P><P>
<BR>
<I CLASS="sans">INTERFACE:</I>
<PRE>   REALTYPE function  q2l_bc(bc,type,zi,ki,z0,u_tau)
</PRE>
<I CLASS="sans">DESCRIPTION:
<BR></I>

<P>
Computes prescribed and flux boundary conditions for  the transport
  equation (<A HREF="node75.html#MY">162</A>). The formal parameter <TT>bc</TT> determines
  whether <TT>Dirchlet</TT> or <TT>Neumann</TT>-type boundary conditions
  are computed. Depending on the physical properties of the
  boundary-layer, the parameter <TT>type</TT> relates either to a <TT>visous</TT>,
  a <TT>logarithmic</TT>, or an <TT>injection</TT>-type boundary-layer.
  In the latter case, the flux of TKE caused by breaking surface waves
  has to be specified. Presently, there is only one possibility
  to do so implemented in GOTM. It is described in section <A HREF="node95.html#sec:fkCraig">4.34</A>.
  All parameters that determine the boundary layer have to be
  set in <TT>gotmturb.nml</TT>.

<P>
Note that  in this section, for brevity, <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img20.png"
 ALT="$ z$"></SPAN> denotes the distance
  from the wall (or the surface), and <SPAN  CLASS="textit">not</SPAN> the standard
  coordinate of the same name used in GOTM.

<P>
<BR>
<BR>
  <B>Viscous boundary-layers</B>
  <BR>
<BR>

<P>
This type is not implemented yet in GOTM.

<P>
<BR>
<BR>
  <B>Logarithmic boundary-layers</B>
  <BR>
<BR>

<P>
The Dirchlet (prescribed) boundary conditions can be written as
  <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="MY_q2l_Dirichlet"></A><!-- MATH
 \begin{equation}
q^2 l = 2 \kappa k (z+z_0)
   \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="150" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img555.png"
 ALT="$\displaystyle q^2 l = 2 \kappa k (z+z_0) \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">144</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where we used the law-of-the-wall relation <!-- MATH
 $l=\kappa(z+z_0)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="94" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img546.png"
 ALT="$ l=\kappa(z+z_0)$"></SPAN>.

<P>
Neumann (flux) boundary condition can be written as
  <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="MY_q2l_Neumann"></A><!-- MATH
 \begin{equation}
F_l = - S_l q l \dfrac{\partial {q^2 l}}{\partial {z}}
       = - 2 \sqrt{2} S_l \kappa^2 k^\frac{3}{2} (z+z_0)
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="280" HEIGHT="57" ALIGN="MIDDLE" BORDER="0"
 SRC="img556.png"
 ALT="$\displaystyle F_l = - S_l q l \dfrac{\partial {q^2 l}}{\partial {z}} = - 2 \sqrt{2} S_l \kappa^2 k^\frac{3}{2} (z+z_0)$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">145</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
by inserting <!-- MATH
 $l=\kappa(z+z_0)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="94" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img546.png"
 ALT="$ l=\kappa(z+z_0)$"></SPAN> (<SPAN CLASS="MATH"><IMG
 WIDTH="11" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img174.png"
 ALT="$ q$"></SPAN> is constant in the log-layer).
  Note, that in (<A HREF="#MY_q2l_Dirichlet">144</A>) and
  (<A HREF="#MY_q2l_Neumann">145</A>), we use <TT>ki</TT>, the value of <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ k$"></SPAN> at the current time
  step, to compute the boundary conditions. By means of
  (<A HREF="node51.html#kLog">103</A>), it would have been also possible to express the boundary
  conditions in terms of the friction velocity, <SPAN CLASS="MATH"><IMG
 WIDTH="20" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img548.png"
 ALT="$ u_*$"></SPAN>. This, however,
  causes numerical difficulties in case of a stress-free surface
  boundary-layer as for example in the pressure-driven open channel
  flow.

<P>
<BR>
<BR>
  <B>Shear-free boundary-layers with injection of TKE</B>
  <BR>
<BR>

<P>
The Dirichlet (prescribed) boundary condition follows simply
  from the power-law (<A HREF="node51.html#power_law">110</A>), yielding
  <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="MY_q2l_wave_Dirichlet"></A><!-- MATH
 \begin{equation}
q^2 l = 2 K  L (z+z_0)^{\alpha + 1}
    \quad .
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="178" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img557.png"
 ALT="$\displaystyle q^2 l = 2 K L (z+z_0)^{\alpha + 1} \quad .$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">146</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
Neumann (flux) boundary condition is
  <P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="MY_q2l_wave_Neumann"></A><!-- MATH
 \begin{equation}
F_l = - S_l q l \dfrac{\partial {q^2 l}}{\partial {z}} =
    - 2 \sqrt{2} S_l  (\alpha+1) K^\frac{3}{2}  L^2 (z+ z_0)^{\frac{3}{2} \alpha + 1}
    \; , \quad
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="397" HEIGHT="57" ALIGN="MIDDLE" BORDER="0"
 SRC="img558.png"
 ALT="$\displaystyle F_l = - S_l q l \dfrac{\partial {q^2 l}}{\partial {z}} = - 2 \sqrt{2} S_l (\alpha+1) K^\frac{3}{2} L^2 (z+ z_0)^{\frac{3}{2} \alpha + 1} \; , \quad$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">147</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
which follows from (<A HREF="node51.html#power_law">110</A>). The parameter <SPAN CLASS="MATH"><IMG
 WIDTH="18" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img463.png"
 ALT="$ K$"></SPAN> is
  computed as described in the context of (<A HREF="node63.html#MY_K">135</A>).

<P>

<P><P>
<BR>
<EM>USES:</EM>
<PRE>   IMPLICIT NONE
</PRE><EM>INPUT PARAMETERS:</EM>
<PRE>   integer, intent(in)                 :: bc,type
   REALTYPE, intent(in)                :: zi,ki,z0,u_tau
</PRE><I CLASS="sans">REVISION HISTORY:</I>
<PRE>   Original author(s): Lars Umlauf
</PRE>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1288"
  HREF="node67.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1284"
  HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1278"
  HREF="node65.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1286"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1289"
  HREF="node67.html">Clean up the turbulence</A>
<B> Up:</B> <A NAME="tex2html1285"
  HREF="node48.html">Module turbulence: its all</A>
<B> Previous:</B> <A NAME="tex2html1279"
  HREF="node65.html">Boundary conditons for the</A>
 &nbsp; <B>  <A NAME="tex2html1287"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Karsten Bolding
2012-12-28
</ADDRESS>
</BODY>
</HTML>
